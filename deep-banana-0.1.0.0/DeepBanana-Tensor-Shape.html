<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DeepBanana.Tensor.Shape</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_DeepBanana-Tensor-Shape.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/DeepBanana-Tensor-Shape.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">deep-banana-0.1.0.0: A GPU accelerated deep learning library.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">DeepBanana.Tensor.Shape</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Shape type class</a></li><li><a href="#g:2">Type-level arithmetic utilities</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Shape type class and instances. Defines the shape of a tensor, both at the type level and value level.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">class</span> <a href="#t:Shape">Shape</a> s <span class="keyword">where</span><ul class="subs"><li><span class="keyword">type</span> <a href="#t:Size">Size</a> s :: <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a></li><li><span class="keyword">type</span> <a href="#t:Nbdim">Nbdim</a> s :: <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a></li><li><a href="#v:shape">shape</a> :: <a href="../base-4.7.0.2/Data-Proxy.html#t:Proxy">Proxy</a> s -&gt; [<a href="../base-4.7.0.2/Data-Int.html#t:Int">Int</a>]</li><li><a href="#v:nbdim">nbdim</a> :: <a href="../base-4.7.0.2/Data-Proxy.html#t:Proxy">Proxy</a> s -&gt; <a href="../base-4.7.0.2/Data-Int.html#t:Int">Int</a></li><li><a href="#v:size">size</a> :: <a href="../base-4.7.0.2/Data-Proxy.html#t:Proxy">Proxy</a> s -&gt; <a href="../base-4.7.0.2/Data-Int.html#t:Int">Int</a></li></ul></li><li class="src short"><span class="keyword">type family</span> <a href="#t:Quotient">Quotient</a> m n</li><li class="src short"><span class="keyword">type family</span> <a href="#t:Remainder">Remainder</a> m n</li><li class="src short"><span class="keyword">type family</span> <a href="#t:Max">Max</a> m n</li></ul></div><div id="interface"><h1 id="g:1">Shape type class</h1><div class="doc"><p>The <code><a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a></code> type class can only be implemented by types of kind '[Nat]'. These fully
define the shape of a given tensor at the type level. Further, <code><a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a></code> also requires its
instances to have size and number of dimension information available, both at the type
level and the value level. These informations are used to ensure at compile time that
most operations on tensor are correctly applied.</p><p>It also means that currently, we cannot handle tensors with (even partially) dynamic
shapes. Although this is rarely an issue when training a neural network - which mostly
expect inputs of a given size - 2d convolution layers are sometimes applied to inputs
of varying width and height at test time. This should be adressed in the future.</p></div><div class="top"><p class="src"><span class="keyword">class</span> <a name="t:Shape" class="def">Shape</a> s <span class="keyword">where</span> <a href="src/DeepBanana-Tensor-Shape.html#Shape" class="link">Source</a></p><div class="doc"><p>Type class for tensor shapes.</p></div><div class="subs minimal"><p class="caption">Minimal complete definition</p><p class="src"><a href="DeepBanana-Tensor-Shape.html#v:shape">shape</a></p></div><div class="subs associated-types"><p class="caption">Associated Types</p><p class="src"><span class="keyword">type</span> <a name="t:Size" class="def">Size</a> s :: <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a> <a href="src/DeepBanana-Tensor-Shape.html#Size" class="link">Source</a></p><div class="doc"><p>The size, i.e. the total number of elements of a tensor of shape s, at the type
   level. By convention, we set the empty type-level list to size 0.</p></div><p class="src"><span class="keyword">type</span> <a name="t:Nbdim" class="def">Nbdim</a> s :: <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a> <a href="src/DeepBanana-Tensor-Shape.html#Nbdim" class="link">Source</a></p><div class="doc"><p>The number of dimensions of a tensor of shape s. For instance:</p><pre>  Nbdim '[] ~ 0
  Nbdim '[5] ~ 1
  Nbdim '[6,8] ~ 2
</pre></div></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:shape" class="def">shape</a> :: <a href="../base-4.7.0.2/Data-Proxy.html#t:Proxy">Proxy</a> s -&gt; [<a href="../base-4.7.0.2/Data-Int.html#t:Int">Int</a>] <a href="src/DeepBanana-Tensor-Shape.html#shape" class="link">Source</a></p><div class="doc"><p>Value-level shape of a tensor with type-level shape s.</p></div><p class="src"><a name="v:nbdim" class="def">nbdim</a> :: <a href="../base-4.7.0.2/Data-Proxy.html#t:Proxy">Proxy</a> s -&gt; <a href="../base-4.7.0.2/Data-Int.html#t:Int">Int</a> <a href="src/DeepBanana-Tensor-Shape.html#nbdim" class="link">Source</a></p><div class="doc"><p>Value-level number of dimensions of a tensor with type-level shape s.</p></div><p class="src"><a name="v:size" class="def">size</a> :: <a href="../base-4.7.0.2/Data-Proxy.html#t:Proxy">Proxy</a> s -&gt; <a href="../base-4.7.0.2/Data-Int.html#t:Int">Int</a> <a href="src/DeepBanana-Tensor-Shape.html#size" class="link">Source</a></p><div class="doc"><p>Value-level size, or number of elements of a tensor with type-level shape s. As
   with the type-level example, we set the empty type-level list to size 0.</p></div></div><div class="subs instances"><p id="control.i:Shape" class="caption collapser" onclick="toggleSection('i:Shape')">Instances</p><div id="section.i:Shape" class="show"><table><tr><td class="src"><a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> ([] <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a>)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">(<a href="../base-4.7.0.2/GHC-TypeLits.html#t:KnownNat">KnownNat</a> e1, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> ((:) <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a> e2 l)) =&gt; <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> ((:) <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a> e1 ((:) <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a> e2 l))</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a href="../base-4.7.0.2/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> ((:) <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a> n ([] <a href="../base-4.7.0.2/GHC-TypeLits.html#t:Nat">Nat</a>))</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><h1 id="g:2">Type-level arithmetic utilities</h1><div class="doc"><p>Some helper type families to compute mathematical operation in addition to the
operations provided by <a href="../base-4.7.0.2/GHC-TypeLits.html">GHC.TypeLits</a>. Used for computing convolution and pooling output
shape at compile time.</p></div><div class="top"><p class="src"><span class="keyword">type family</span> <a name="t:Quotient" class="def">Quotient</a> m n <a href="src/DeepBanana-Tensor-Shape.html#Quotient" class="link">Source</a></p><div class="doc"><p>Type level function to compute the quotient of the division of <code>m</code> by <code>n</code>.</p><pre>  natVal (Proxy :: Proxy (Quotient m n)) == natVal (Proxy :: Proxy m) <code><a href="../base-4.7.0.2/Prelude.html#v:div">div</a></code> natVal (Proxy :: Proxy n)
</pre></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="DeepBanana-Tensor-Shape.html#t:Quotient">Quotient</a> m n = Quotient' m n (<a href="../base-4.7.0.2/GHC-TypeLits.html#t:CmpNat">CmpNat</a> m n)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type family</span> <a name="t:Remainder" class="def">Remainder</a> m n <a href="src/DeepBanana-Tensor-Shape.html#Remainder" class="link">Source</a></p><div class="doc"><p>Type level function to compute the remainder of the division of <code>m</code> by <code>n</code>.</p><pre>  natVal (Proxy :: Proxy (Remainder m n)) == natVal (Proxy :: Proxy m) <code><a href="../base-4.7.0.2/Prelude.html#v:rem">rem</a></code> natVal (Proxy :: Proxy n)
</pre></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="DeepBanana-Tensor-Shape.html#t:Remainder">Remainder</a> m n = Remainder' m n (<a href="../base-4.7.0.2/GHC-TypeLits.html#t:CmpNat">CmpNat</a> m n)</td><td class="doc empty">&nbsp;</td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type family</span> <a name="t:Max" class="def">Max</a> m n <a href="src/DeepBanana-Tensor-Shape.html#Max" class="link">Source</a></p><div class="doc"><p>Type level max function for type-level natural numbers.</p><pre>  natVal (Proxy :: Proxy (Max m n)) == max (natVal (Proxy :: Proxy m)) (natVal (Proxy :: Proxy n))
</pre></div><div class="subs equations"><p class="caption">Equations</p><table><tr><td class="src"><a href="DeepBanana-Tensor-Shape.html#t:Max">Max</a> m n = Max' m n (<a href="../base-4.7.0.2/GHC-TypeLits.html#t:CmpNat">CmpNat</a> m n)</td><td class="doc empty">&nbsp;</td></tr></table></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.15.0.2</p></div></body></html>