<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DeepBanana.Exception</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_DeepBanana-Exception.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/DeepBanana-Exception.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">deep-banana-0.1.0.0: A GPU accelerated deep learning library.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">DeepBanana.Exception</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Extensible ariants of exception datatypes</a></li><li><a href="#g:2">Stack traces</a></li><li><a href="#g:3">Managing exception monads</a></li><li><a href="#g:4">Specific handlers</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>A stab at an extensible exceptions system, used internally. To be displaced eventually by whatever &quot;composable effects&quot; library becomes the de facto standard in the Haskell community.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:Coproduct">Coproduct</a> l <span class="keyword">where</span><ul class="subs"><li><a href="#v:Left-39-">Left'</a> ::  a -&gt; <a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> (a : l)</li><li><a href="#v:Right-39-">Right'</a> ::  <a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> l -&gt; <a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> (a : l)</li></ul></li><li class="src short"><span class="keyword">class</span> <a href="#t:Variant">Variant</a> t e <span class="keyword">where</span><ul class="subs"><li><a href="#v:setVariant">setVariant</a> :: e -&gt; t</li><li><a href="#v:getVariant">getVariant</a> :: t -&gt; <a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a> e</li></ul></li><li class="src short"><a href="#v:throwVariant">throwVariant</a> :: (<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e) =&gt; e -&gt; m a</li><li class="src short"><a href="#v:catchVariant">catchVariant</a> :: <span class="keyword">forall</span> m t e a. (<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e) =&gt; m a -&gt; (e -&gt; m a) -&gt; m a</li><li class="src short"><span class="keyword">data</span> <a href="#t:WithStack">WithStack</a> e</li><li class="src short"><a href="#v:withStack">withStack</a> :: (?loc :: <a href="../base-4.8.2.0/GHC-Stack.html#t:CallStack">CallStack</a>) =&gt; e -&gt; <a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e</li><li class="src short"><a href="#v:unsafeRunExcept">unsafeRunExcept</a> :: <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e a -&gt; a</li><li class="src short"><a href="#v:embedExcept">embedExcept</a> :: <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> e m =&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e a -&gt; m a</li><li class="src short"><a href="#v:runExceptTAs">runExceptTAs</a> :: <a href="../base-4.8.2.0/Data-Proxy.html#t:Proxy">Proxy</a> t -&gt; <a href="../mtl-2.2.1/Control-Monad-Except.html#t:ExceptT">ExceptT</a> t m a -&gt; m (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> t a)</li><li class="src short"><a href="#v:attemptGCThenRetryOn">attemptGCThenRetryOn</a> :: <span class="keyword">forall</span> m t e a. (<a href="../basic-prelude-0.5.1/CorePrelude.html#t:MonadIO">MonadIO</a> m, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e) =&gt; <a href="../base-4.8.2.0/Data-Proxy.html#t:Proxy">Proxy</a> e -&gt; m a -&gt; m a</li></ul></div><div id="interface"><h1 id="g:1">Extensible ariants of exception datatypes</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:Coproduct" class="def">Coproduct</a> l <span class="keyword">where</span> <a href="src/DeepBanana-Exception.html#Coproduct" class="link">Source</a></p><div class="doc"><p>Coproduct of datatypes, indexed by a type-level lists of these datatypes.
 For instance, <code><code><a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a></code> '[a,b]</code> is equivalent to <code><code><a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a></code> a b</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:Left-39-" class="def">Left'</a> ::  a -&gt; <a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> (a : l)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src"><a name="v:Right-39-" class="def">Right'</a> ::  <a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> l -&gt; <a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> (a : l)</td><td class="doc empty">&nbsp;</td></tr></table></div><div class="subs instances"><p id="control.i:Coproduct" class="caption collapser" onclick="toggleSection('i:Coproduct')">Instances</p><div id="section.i:Coproduct" class="show"><table><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> a, <a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> b)) =&gt; <a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b))</span> <a href="src/DeepBanana-Exception.html#line-63" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> a =&gt; <a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a ([] *)))</span> <a href="src/DeepBanana-Exception.html#line-60" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> a, <a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> b), <a href="../base-4.8.2.0/Data-Typeable-Internal.html#t:Typeable">Typeable</a> * a, <a href="../base-4.8.2.0/Data-Typeable-Internal.html#t:Typeable">Typeable</a> [*] b, <a href="../base-4.8.2.0/Data-Typeable-Internal.html#t:Typeable">Typeable</a> * (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> b)) =&gt; <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b))</span> <a href="src/DeepBanana-Exception.html#line-74" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> a, <a href="../base-4.8.2.0/Data-Typeable-Internal.html#t:Typeable">Typeable</a> * a) =&gt; <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a ([] *)))</span> <a href="src/DeepBanana-Exception.html#line-73" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> a, <a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> b)) =&gt; <a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b))</span> <a href="src/DeepBanana-Exception.html#line-37" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> a =&gt; <a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a ([] *)))</span> <a href="src/DeepBanana-Exception.html#line-34" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b)) a</span> <a href="src/DeepBanana-Exception.html#line-55" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> b) e =&gt; <a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b)) e</span> <a href="src/DeepBanana-Exception.html#line-50" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><span class="keyword">class</span> <a name="t:Variant" class="def">Variant</a> t e <span class="keyword">where</span> <a href="src/DeepBanana-Exception.html#Variant" class="link">Source</a></p><div class="doc"><p>Type class to deal with variant datatypes in a generic fashion.</p></div><div class="subs methods"><p class="caption">Methods</p><p class="src"><a name="v:setVariant" class="def">setVariant</a> :: e -&gt; t <a href="src/DeepBanana-Exception.html#setVariant" class="link">Source</a></p><p class="src"><a name="v:getVariant" class="def">getVariant</a> :: t -&gt; <a href="../base-4.8.2.0/Data-Maybe.html#t:Maybe">Maybe</a> e <a href="src/DeepBanana-Exception.html#getVariant" class="link">Source</a></p></div><div class="subs instances"><p id="control.i:Variant" class="caption collapser" onclick="toggleSection('i:Variant')">Instances</p><div id="section.i:Variant" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> a a</span> <a href="src/DeepBanana-Exception.html#line-46" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e =&gt; <a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> t) e</span> <a href="src/DeepBanana-Exception.html#line-107" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b)) a</span> <a href="src/DeepBanana-Exception.html#line-55" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> b) e =&gt; <a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:Coproduct">Coproduct</a> ((:) * a b)) e</span> <a href="src/DeepBanana-Exception.html#line-50" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:throwVariant" class="def">throwVariant</a> :: (<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e) =&gt; e -&gt; m a <a href="src/DeepBanana-Exception.html#throwVariant" class="link">Source</a></p><div class="doc"><p>Throwing an exception when the error datatype is a variant including that datatype.</p></div></div><div class="top"><p class="src"><a name="v:catchVariant" class="def">catchVariant</a> :: <span class="keyword">forall</span> m t e a. (<a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e) =&gt; m a -&gt; (e -&gt; m a) -&gt; m a <a href="src/DeepBanana-Exception.html#catchVariant" class="link">Source</a></p><div class="doc"><p>Catching one possible exception type out of a variant.</p></div></div><h1 id="g:2">Stack traces</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:WithStack" class="def">WithStack</a> e <a href="src/DeepBanana-Exception.html#WithStack" class="link">Source</a></p><div class="doc"><p>Simple wrapper adding a call stack to an arbitrary exception.</p></div><div class="subs instances"><p id="control.i:WithStack" class="caption collapser" onclick="toggleSection('i:WithStack')">Instances</p><div id="section.i:WithStack" class="show"><table><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> e =&gt; <a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e)</span> <a href="src/DeepBanana-Exception.html#line-95" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> e =&gt; <a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e)</span> <a href="src/DeepBanana-Exception.html#line-99" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../base-4.8.2.0/GHC-Generics.html#t:Generic">Generic</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e)</span> <a href="src/DeepBanana-Exception.html#line-95" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left">(<a href="../base-4.8.2.0/Data-Eq.html#t:Eq">Eq</a> e, <a href="../base-4.8.2.0/Text-Show.html#t:Show">Show</a> e, <a href="../base-4.8.2.0/Data-Typeable-Internal.html#t:Typeable">Typeable</a> * e) =&gt; <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e)</span> <a href="src/DeepBanana-Exception.html#line-102" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> e =&gt; <a href="../deepseq-1.4.1.1/Control-DeepSeq.html#t:NFData">NFData</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e)</span> <a href="src/DeepBanana-Exception.html#line-97" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e =&gt; <a href="DeepBanana-Exception.html#t:Variant">Variant</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> t) e</span> <a href="src/DeepBanana-Exception.html#line-107" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr><tr><td class="src clearfix"><span class="inst-left"><span class="keyword">type</span> <a href="../base-4.8.2.0/GHC-Generics.html#t:Rep">Rep</a> (<a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e)</span> <a href="src/DeepBanana-Exception.html#line-92" class="link">Source</a></td><td class="doc empty">&nbsp;</td></tr></table></div></div></div><div class="top"><p class="src"><a name="v:withStack" class="def">withStack</a> :: (?loc :: <a href="../base-4.8.2.0/GHC-Stack.html#t:CallStack">CallStack</a>) =&gt; e -&gt; <a href="DeepBanana-Exception.html#t:WithStack">WithStack</a> e <a href="src/DeepBanana-Exception.html#withStack" class="link">Source</a></p></div><h1 id="g:3">Managing exception monads</h1><div class="top"><p class="src"><a name="v:unsafeRunExcept" class="def">unsafeRunExcept</a> :: <a href="../base-4.8.2.0/Control-Exception-Base.html#t:Exception">Exception</a> e =&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e a -&gt; a <a href="src/DeepBanana-Exception.html#unsafeRunExcept" class="link">Source</a></p><div class="doc"><p>Gets the <code><code><a href="../base-4.8.2.0/Data-Either.html#v:Right">Right</a></code></code> part of a computation, throwing an imprecise exception
 in case of <code><code><a href="../base-4.8.2.0/Data-Either.html#v:Left">Left</a></code></code>.</p></div></div><div class="top"><p class="src"><a name="v:embedExcept" class="def">embedExcept</a> :: <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> e m =&gt; <a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> e a -&gt; m a <a href="src/DeepBanana-Exception.html#embedExcept" class="link">Source</a></p><div class="doc"><p>Embeds an <code><code><a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a></code></code> value into an arbitrary error monad.</p></div></div><div class="top"><p class="src"><a name="v:runExceptTAs" class="def">runExceptTAs</a> :: <a href="../base-4.8.2.0/Data-Proxy.html#t:Proxy">Proxy</a> t -&gt; <a href="../mtl-2.2.1/Control-Monad-Except.html#t:ExceptT">ExceptT</a> t m a -&gt; m (<a href="../base-4.8.2.0/Data-Either.html#t:Either">Either</a> t a) <a href="src/DeepBanana-Exception.html#runExceptTAs" class="link">Source</a></p><div class="doc"><p>Synonym for <code><code><a href="../mtl-2.2.1/Control-Monad-Except.html#t:ExceptT">ExceptT</a></code></code> specifying the exception type via a <code><code><a href="../base-4.8.2.0/Data-Proxy.html#t:Proxy">Proxy</a></code></code>. Useful to
 disambiguate types for the compiler.</p></div></div><h1 id="g:4">Specific handlers</h1><div class="top"><p class="src"><a name="v:attemptGCThenRetryOn" class="def">attemptGCThenRetryOn</a> :: <span class="keyword">forall</span> m t e a. (<a href="../basic-prelude-0.5.1/CorePrelude.html#t:MonadIO">MonadIO</a> m, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t e) =&gt; <a href="../base-4.8.2.0/Data-Proxy.html#t:Proxy">Proxy</a> e -&gt; m a -&gt; m a <a href="src/DeepBanana-Exception.html#attemptGCThenRetryOn" class="link">Source</a></p><div class="doc"><p>Runs a computation, and in case of a specific exception being raised performs
 garbage collection before attempting the computation again. This is useful when
 allocating a lot of memory quickly on the GPU, as the garbage collector may not have
 enough time to run by itself. Throws back the same exception if the second run fails
 anyway. This is used anytime an allocation is performed on a GPU device, most notably
 <code><code><a href="DeepBanana-Tensor-Mutable.html#v:emptyTensor">emptyTensor</a></code></code> and other tensor creation functions.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>