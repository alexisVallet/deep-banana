<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>DeepBanana.Tensor.Mutable</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_DeepBanana-Tensor-Mutable.html");};
//]]>
</script></head><body><div id="package-header"><ul class="links" id="page-menu"><li><a href="src/DeepBanana-Tensor-Mutable.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul><p class="caption">deep-banana-0.1.0.0: A GPU accelerated deep learning library.</p></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">DeepBanana.Tensor.Mutable</p></div><div id="table-of-contents"><p class="caption">Contents</p><ul><li><a href="#g:1">Creating mutable tensors</a></li><li><a href="#g:2">Basic manipulations</a></li><li><a href="#g:3">In place numeric functions</a></li><li><a href="#g:4">Re-exports</a></li></ul></div><div id="description"><p class="caption">Description</p><div class="doc"><p>Mutable GPU multi-dimensional dense numeric arrays, parametrized by the state token of
some primitive state monad.</p></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><span class="keyword">data</span> <a href="#t:MTensor">MTensor</a> st d s a = <a href="#v:MTensor">MTensor</a> {<ul class="subs"><li><a href="#v:shape">shape</a> :: s</li><li><a href="#v:dataptr">dataptr</a> :: <a href="../base-4.8.2.0/Foreign-ForeignPtr.html#t:ForeignPtr">ForeignPtr</a> a</li></ul>}</li><li class="src short"><span class="keyword">type</span> <a href="#t:IOTensor">IOTensor</a> = <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> <a href="../base-4.8.2.0/Control-Monad-ST.html#t:RealWorld">RealWorld</a></li><li class="src short"><a href="#v:dtype">dtype</a> :: <span class="keyword">forall</span> m d n a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d n a -&gt; m <a href="DeepBanana-Device-CuDNN.html#t:DataType">DataType</a></li><li class="src short"><a href="#v:emptyTensor">emptyTensor</a> :: <span class="keyword">forall</span> s d m t a. (<a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; s -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a)</li><li class="src short"><a href="#v:tensorFromList">tensorFromList</a> :: <span class="keyword">forall</span> m d s a t. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:IncompatibleSize">IncompatibleSize</a>) =&gt; s -&gt; [a] -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a)</li><li class="src short"><a href="#v:zeros">zeros</a> :: (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; s -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a)</li><li class="src short"><a href="#v:ones">ones</a> :: (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; s -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a)</li><li class="src short"><a href="#v:withDevicePtr">withDevicePtr</a> :: <a href="../base-4.8.2.0/Foreign-Storable.html#t:Storable">Storable</a> a =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:IOTensor">IOTensor</a> d s a -&gt; (<a href="../cuda-0.7.0.0/Foreign-CUDA-Types.html#t:DevicePtr">DevicePtr</a> a -&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> b) -&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> b</li><li class="src short"><a href="#v:reshape">reshape</a> :: (<a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s1, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s2, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:IncompatibleSize">IncompatibleSize</a>) =&gt; s2 -&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s1 a -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s2 a)</li><li class="src short"><a href="#v:reshape-39-">reshape'</a> :: <span class="keyword">forall</span> d s1 s2 st a. (<a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s1, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s2) =&gt; s2 -&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s1 a -&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s2 a</li><li class="src short"><a href="#v:copy">copy</a> :: <span class="keyword">forall</span> m d1 d2 s a t. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d2, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d1 s a -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d2 s a)</li><li class="src short"><a href="#v:tensorToList">tensorToList</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m [a]</li><li class="src short"><a href="#v:threshInplace">threshInplace</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; a -&gt; m ()</li><li class="src short"><a href="#v:tlog">tlog</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m ()</li><li class="src short"><a href="#v:texp">texp</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m ()</li><li class="src short"><a href="#v:inv">inv</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m ()</li><li class="src short">module <a href="DeepBanana-Tensor-Shape.html">DeepBanana.Tensor.Shape</a></li><li class="src short">module <a href="DeepBanana-Tensor-TensorScalar.html">DeepBanana.Tensor.TensorScalar</a></li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><span class="keyword">data</span> <a name="t:MTensor" class="def">MTensor</a> st d s a <a href="src/DeepBanana-Tensor-Mutable.html#MTensor" class="link">Source</a></p><div class="doc"><p>Mutable tensor, parametrized by some state token <code>st</code>, stored on a device <code>d</code>, with
 shape <code>s</code> and scalar datatype <code>a</code>.</p></div><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a name="v:MTensor" class="def">MTensor</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><dl><dt class="src"><a name="v:shape" class="def">shape</a> :: s</dt><dd class="doc empty">&nbsp;</dd><dt class="src"><a name="v:dataptr" class="def">dataptr</a> :: <a href="../base-4.8.2.0/Foreign-ForeignPtr.html#t:ForeignPtr">ForeignPtr</a> a</dt><dd class="doc empty">&nbsp;</dd></dl><div class="clear"></div></div></td></tr></table></div></div><div class="top"><p class="src"><span class="keyword">type</span> <a name="t:IOTensor" class="def">IOTensor</a> = <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> <a href="../base-4.8.2.0/Control-Monad-ST.html#t:RealWorld">RealWorld</a> <a href="src/DeepBanana-Tensor-Mutable.html#IOTensor" class="link">Source</a></p><div class="doc"><p>Convenient synonym for mutable tensors in the <code>IO</code> monad.</p></div></div><div class="top"><p class="src"><a name="v:dtype" class="def">dtype</a> :: <span class="keyword">forall</span> m d n a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d n a -&gt; m <a href="DeepBanana-Device-CuDNN.html#t:DataType">DataType</a> <a href="src/DeepBanana-Tensor-Mutable.html#dtype" class="link">Source</a></p><div class="doc"><p>Returns the CuDNN datatype identifier for the tensor.</p></div></div><h1 id="g:1">Creating mutable tensors</h1><div class="top"><p class="src"><a name="v:emptyTensor" class="def">emptyTensor</a> :: <span class="keyword">forall</span> s d m t a. (<a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; s -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a) <a href="src/DeepBanana-Tensor-Mutable.html#emptyTensor" class="link">Source</a></p><div class="doc"><p>Creates an uninitialized mutable tensor with a given shape. Uninitialized means the
 contents of the tensor are defined by whatever was lying around in memory at the
 time. In case there is not enough space on the device, will throw and <code><code><a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a></code></code>
 exception after attempting garbage collection first.</p></div></div><div class="top"><p class="src"><a name="v:tensorFromList" class="def">tensorFromList</a> :: <span class="keyword">forall</span> m d s a t. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:IncompatibleSize">IncompatibleSize</a>) =&gt; s -&gt; [a] -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a) <a href="src/DeepBanana-Tensor-Mutable.html#tensorFromList" class="link">Source</a></p><div class="doc"><p>Creates a mutable tensor from a list. Throws an exception at runtime when the size
 of the list does not correspond to the desired shape.</p></div></div><div class="top"><p class="src"><a name="v:zeros" class="def">zeros</a> :: (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; s -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a) <a href="src/DeepBanana-Tensor-Mutable.html#zeros" class="link">Source</a></p><div class="doc"><p>Creates a mutable tensor filled with zeros.</p></div></div><div class="top"><p class="src"><a name="v:ones" class="def">ones</a> :: (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; s -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a) <a href="src/DeepBanana-Tensor-Mutable.html#ones" class="link">Source</a></p><div class="doc"><p>Creates a mutable tensor filled with ones.</p></div></div><h1 id="g:2">Basic manipulations</h1><div class="top"><p class="src"><a name="v:withDevicePtr" class="def">withDevicePtr</a> :: <a href="../base-4.8.2.0/Foreign-Storable.html#t:Storable">Storable</a> a =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:IOTensor">IOTensor</a> d s a -&gt; (<a href="../cuda-0.7.0.0/Foreign-CUDA-Types.html#t:DevicePtr">DevicePtr</a> a -&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> b) -&gt; <a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a> b <a href="src/DeepBanana-Tensor-Mutable.html#withDevicePtr" class="link">Source</a></p><div class="doc"><p>Runs an <code><a href="../base-4.8.2.0/System-IO.html#t:IO">IO</a></code> action with the internal device pointer of a given mutable tensor.</p></div></div><div class="top"><p class="src"><a name="v:reshape" class="def">reshape</a> :: (<a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s1, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s2, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:IncompatibleSize">IncompatibleSize</a>) =&gt; s2 -&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s1 a -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s2 a) <a href="src/DeepBanana-Tensor-Mutable.html#reshape" class="link">Source</a></p><div class="doc"><p>Tensor reshaping. Will throw and <code><code><a href="DeepBanana-Tensor-Exception.html#t:IncompatibleSize">IncompatibleSize</a></code></code> exception if the desired
 shape size does not correspond to the input tensor size.</p></div></div><div class="top"><p class="src"><a name="v:reshape-39-" class="def">reshape'</a> :: <span class="keyword">forall</span> d s1 s2 st a. (<a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s1, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s2) =&gt; s2 -&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s1 a -&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> st d s2 a <a href="src/DeepBanana-Tensor-Mutable.html#reshape%27" class="link">Source</a></p><div class="doc"><p>Unsafe pure tensor reshaping, which throws an imprecise exception when the desired
 shape size does not correspond to the input tensor size.</p></div></div><div class="top"><p class="src"><a name="v:copy" class="def">copy</a> :: <span class="keyword">forall</span> m d1 d2 s a t. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d2, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a, <a href="../mtl-2.2.1/Control-Monad-Error-Class.html#t:MonadError">MonadError</a> t m, <a href="DeepBanana-Exception.html#t:Variant">Variant</a> t <a href="DeepBanana-Tensor-Exception.html#t:OutOfMemory">OutOfMemory</a>) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d1 s a -&gt; m (<a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d2 s a) <a href="src/DeepBanana-Tensor-Mutable.html#copy" class="link">Source</a></p><div class="doc"><p>Copies the data of a mutable tensor into a new one.</p></div></div><div class="top"><p class="src"><a name="v:tensorToList" class="def">tensorToList</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m [a] <a href="src/DeepBanana-Tensor-Mutable.html#tensorToList" class="link">Source</a></p><div class="doc"><p>Converts a mutable tensor to a list of elements.</p></div></div><h1 id="g:3">In place numeric functions</h1><div class="top"><p class="src"><a name="v:threshInplace" class="def">threshInplace</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; a -&gt; m () <a href="src/DeepBanana-Tensor-Mutable.html#threshInplace" class="link">Source</a></p><div class="doc"><p>Thresholds a mutable tensor in place. Used to implement dropout.</p></div></div><div class="top"><p class="src"><a name="v:tlog" class="def">tlog</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m () <a href="src/DeepBanana-Tensor-Mutable.html#tlog" class="link">Source</a></p><div class="doc"><p>In place logarithm.</p></div></div><div class="top"><p class="src"><a name="v:texp" class="def">texp</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m () <a href="src/DeepBanana-Tensor-Mutable.html#texp" class="link">Source</a></p><div class="doc"><p>In place exponential.</p></div></div><div class="top"><p class="src"><a name="v:inv" class="def">inv</a> :: <span class="keyword">forall</span> m d s a. (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimMonad">PrimMonad</a> m, <a href="DeepBanana-Device-Monad.html#t:Device">Device</a> d, <a href="DeepBanana-Tensor-Shape.html#t:Shape">Shape</a> s, <a href="DeepBanana-Tensor-TensorScalar.html#t:TensorScalar">TensorScalar</a> a) =&gt; <a href="DeepBanana-Tensor-Mutable.html#t:MTensor">MTensor</a> (<a href="../mutable-containers-0.3.2/Data-Mutable.html#t:PrimState">PrimState</a> m) d s a -&gt; m () <a href="src/DeepBanana-Tensor-Mutable.html#inv" class="link">Source</a></p><div class="doc"><p>In place inverse.</p></div></div><h1 id="g:4">Re-exports</h1><div class="top"><p class="src">module <a href="DeepBanana-Tensor-Shape.html">DeepBanana.Tensor.Shape</a></p></div><div class="top"><p class="src">module <a href="DeepBanana-Tensor-TensorScalar.html">DeepBanana.Tensor.TensorScalar</a></p></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.16.1</p></div></body></html>