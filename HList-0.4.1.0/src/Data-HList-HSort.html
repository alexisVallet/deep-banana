<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<head>
<!-- Generated by HsColour, http://code.haskell.org/~malcolm/hscolour/ -->
<title>Data/HList/HSort.hs</title>
<link type='text/css' rel='stylesheet' href='hscolour.css' />
</head>
<body>
<pre><a name="line-1"></a><span class='hs-comment'>{-# LANGUAGE CPP #-}</span>
<a name="line-2"></a><span class='hs-comment'>{- | Description: sorting
<a name="line-3"></a>
<a name="line-4"></a>Benchmarks for these functions can be found at
<a name="line-5"></a>&lt;<a href="http://code.haskell.org/~aavogt/HList-nodup/Run.html">http://code.haskell.org/~aavogt/HList-nodup/Run.html</a>&gt;.
<a name="line-6"></a>
<a name="line-7"></a>See &lt;Data-HList-CommonMain.html#v:hSort&gt;
<a name="line-8"></a>for the public interface.
<a name="line-9"></a>
<a name="line-10"></a>-}</span>
<a name="line-11"></a><span class='hs-keyword'>module</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span><span class='hs-varop'>.</span><span class='hs-conid'>HSort</span> <span class='hs-keyword'>where</span>
<a name="line-12"></a>
<a name="line-13"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span>
<a name="line-14"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span><span class='hs-varop'>.</span><span class='hs-conid'>FakePrelude</span>
<a name="line-15"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>Data</span><span class='hs-varop'>.</span><span class='hs-conid'>HList</span><span class='hs-varop'>.</span><span class='hs-conid'>Label3</span>
<a name="line-16"></a>
<a name="line-17"></a><span class='hs-cpp'>#if __GLASGOW_HASKELL__ &gt; 707</span>
<a name="line-18"></a><span class='hs-keyword'>import</span> <span class='hs-conid'>GHC</span><span class='hs-varop'>.</span><span class='hs-conid'>TypeLits</span> <span class='hs-layout'>(</span><span class='hs-keyword'>type</span> <span class='hs-layout'>(</span><span class='hs-varop'>&lt;=?</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>CmpSymbol</span><span class='hs-layout'>)</span>
<a name="line-19"></a><a name="instance%20HEqBy%20HLeFn%20x%20y%20b%20--%20%7c%20only%20in%20ghc%20%3e=%207.7%20%7b-%20%7c%20%3e%3e%3e%20let%20b1%20=%20Proxy%20::%20HEqBy%20HLeFn%20%22x%22%20%22y%22%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20b1%20b1%20::%20Proxy%20'True%20%3e%3e%3e%20let%20b2%20=%20Proxy%20::%20HEqBy%20HLeFn%20%22x%22%20%22x%22%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20b2%20b2%20::%20Proxy%20'True%20%3e%3e%3e%20let%20b3%20=%20Proxy%20::%20HEqBy%20HLeFn%20%22y%22%20%22x%22%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20b3%20b3%20::%20Proxy%20'False%20-%7d%20instance%20(HEq%20(CmpSymbol%20x%20y)%20GT%20nb,%20HNot%20nb%20~%20b)%20=%3e%20HEqBy%20HLeFn%20x%20y%20b%20%23endif%20--%20%7c%20the%20%5c%22standard%5c%22%20'%3c='%20for%20types.%20Reuses%20'HEqBy'%20--%20--%20Note%20that%20ghc-7.6%20is%20missing%20instances%20for%20Symbol%20and%20Nat,%20so%20that%20--%20sorting%20only%20works%20'HNat'%20(as%20used%20by%20%22Data.HList.Label3%22).%20data%20HLeFn%20instance%20HEqByFn%20HLeFn%20instance%20(HLe%20x%20y%20~%20b)%20=%3e%20HEqBy%20HLeFn%20x%20y%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-comment'>-- | only in ghc &gt;= 7.7</span>
<a name="line-20"></a><a name="instance%20HEqBy%20HLeFn%20x%20y%20b%20--%20%7c%20only%20in%20ghc%20%3e=%207.7%20%7b-%20%7c%20%3e%3e%3e%20let%20b1%20=%20Proxy%20::%20HEqBy%20HLeFn%20%22x%22%20%22y%22%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20b1%20b1%20::%20Proxy%20'True%20%3e%3e%3e%20let%20b2%20=%20Proxy%20::%20HEqBy%20HLeFn%20%22x%22%20%22x%22%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20b2%20b2%20::%20Proxy%20'True%20%3e%3e%3e%20let%20b3%20=%20Proxy%20::%20HEqBy%20HLeFn%20%22y%22%20%22x%22%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20b3%20b3%20::%20Proxy%20'False%20-%7d%20instance%20(HEq%20(CmpSymbol%20x%20y)%20GT%20nb,%20HNot%20nb%20~%20b)%20=%3e%20HEqBy%20HLeFn%20x%20y%20b%20%23endif%20--%20%7c%20the%20%5c%22standard%5c%22%20'%3c='%20for%20types.%20Reuses%20'HEqBy'%20--%20--%20Note%20that%20ghc-7.6%20is%20missing%20instances%20for%20Symbol%20and%20Nat,%20so%20that%20--%20sorting%20only%20works%20'HNat'%20(as%20used%20by%20%22Data.HList.Label3%22).%20data%20HLeFn%20instance%20HEqByFn%20HLeFn%20instance%20(HLe%20x%20y%20~%20b)%20=%3e%20HEqBy%20HLeFn%20x%20y%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-varop'>&lt;=?</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span>
<a name="line-21"></a><span class='hs-comment'>-- | only in ghc &gt;= 7.7</span>
<a name="line-22"></a>
<a name="line-23"></a><a name="instance%20HEqBy%20HLeFn%20x%20y%20b%20%23endif%20--%20%7c%20the%20%5c%22standard%5c%22%20'%3c='%20for%20types.%20Reuses%20'HEqBy'%20--%20--%20Note%20that%20ghc-7.6%20is%20missing%20instances%20for%20Symbol%20and%20Nat,%20so%20that%20--%20sorting%20only%20works%20'HNat'%20(as%20used%20by%20%22Data.HList.Label3%22).%20data%20HLeFn%20instance%20HEqByFn%20HLeFn%20instance%20(HLe%20x%20y%20~%20b)%20=%3e%20HEqBy%20HLeFn%20x%20y%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-comment'>{- |
<a name="line-24"></a>
<a name="line-25"></a>&gt;&gt;&gt; let b1 = Proxy :: HEqBy HLeFn "x" "y" b =&gt; Proxy b
<a name="line-26"></a>&gt;&gt;&gt; :t b1
<a name="line-27"></a>b1 :: Proxy 'True
<a name="line-28"></a>
<a name="line-29"></a>&gt;&gt;&gt; let b2 = Proxy :: HEqBy HLeFn "x" "x" b =&gt; Proxy b
<a name="line-30"></a>&gt;&gt;&gt; :t b2
<a name="line-31"></a>b2 :: Proxy 'True
<a name="line-32"></a>
<a name="line-33"></a>&gt;&gt;&gt; let b3 = Proxy :: HEqBy HLeFn "y" "x" b =&gt; Proxy b
<a name="line-34"></a>&gt;&gt;&gt; :t b3
<a name="line-35"></a>b3 :: Proxy 'False
<a name="line-36"></a>
<a name="line-37"></a>-}</span>
<a name="line-38"></a><a name="instance%20HEqBy%20HLeFn%20x%20y%20b%20%23endif%20--%20%7c%20the%20%5c%22standard%5c%22%20'%3c='%20for%20types.%20Reuses%20'HEqBy'%20--%20--%20Note%20that%20ghc-7.6%20is%20missing%20instances%20for%20Symbol%20and%20Nat,%20so%20that%20--%20sorting%20only%20works%20'HNat'%20(as%20used%20by%20%22Data.HList.Label3%22).%20data%20HLeFn%20instance%20HEqByFn%20HLeFn%20instance%20(HLe%20x%20y%20~%20b)%20=%3e%20HEqBy%20HLeFn%20x%20y%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HEq</span> <span class='hs-layout'>(</span><span class='hs-conid'>CmpSymbol</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-conid'>GT</span> <span class='hs-varid'>nb</span><span class='hs-layout'>,</span> <span class='hs-conid'>HNot</span> <span class='hs-varid'>nb</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span>
<a name="line-39"></a><span class='hs-cpp'>#endif</span>
<a name="line-40"></a>
<a name="line-41"></a><a name="HEqBy"></a><span class='hs-comment'>-- | the \"standard\" '&lt;=' for types. Reuses 'HEqBy'</span>
<a name="line-42"></a><a name="HEqBy"></a><span class='hs-comment'>--</span>
<a name="line-43"></a><a name="HEqBy"></a><span class='hs-comment'>-- Note that ghc-7.6 is missing instances for Symbol and Nat, so that</span>
<a name="line-44"></a><a name="HEqBy"></a><span class='hs-comment'>-- sorting only works 'HNat' (as used by "Data.HList.Label3").</span>
<a name="line-45"></a><a name="HEqBy"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HLeFn</span>
<a name="line-46"></a>
<a name="line-47"></a><a name="instance%20HEqBy%20HLeFn%20x%20y%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-conid'>HLeFn</span>
<a name="line-48"></a>
<a name="line-49"></a><a name="instance%20HEqBy%20HLeFn%20x%20y%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HLe</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span>
<a name="line-50"></a><a name="instance%20HEqBy%20HLeFn%20(Tagged%20x%20v)%20(Tagged%20y%20w)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>x</span> <span class='hs-varid'>v</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Tagged</span> <span class='hs-varid'>y</span> <span class='hs-varid'>w</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-51"></a><a name="instance%20HEqBy%20HLeFn%20(Label%20x)%20(Label%20y)%20b%20instance%20HEqBy%20HLeFn%20x%20y%20b%20=%3e%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-layout'>(</span><span class='hs-conid'>Label</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Label</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-52"></a><a name="instance%20HEqBy%20HLeFn%20(Proxy%20x)%20(Proxy%20y)%20b%20--%20%7c%20Data.HList.Label3%20labels%20can%20only%20be%20compared%20if%20they%20belong%20--%20to%20the%20same%20namespace.%20instance%20(HEqBy%20HLeFn%20n%20m%20b,%20ns%20~%20ns')%20=%3e%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-53"></a>
<a name="line-54"></a><a name="instance%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-comment'>-- | Data.HList.Label3 labels can only be compared if they belong</span>
<a name="line-55"></a><a name="instance%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-comment'>-- to the same namespace.</span>
<a name="line-56"></a><a name="instance%20HEqBy%20HLeFn%20(Lbl%20n%20ns%20desc)%20(Lbl%20m%20ns'%20desc')%20b%20--%20%7c%20analogous%20to%20'Data.Ord.Down'%20data%20HDown%20a%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>n</span> <span class='hs-varid'>m</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-varid'>ns</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>ns'</span><span class='hs-layout'>)</span>
<a name="line-57"></a>     <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>n</span> <span class='hs-varid'>ns</span> <span class='hs-varid'>desc</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>Lbl</span> <span class='hs-varid'>m</span> <span class='hs-varid'>ns'</span> <span class='hs-varid'>desc'</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span>
<a name="line-58"></a>
<a name="line-59"></a>
<a name="line-60"></a><a name="HEqByFn"></a><span class='hs-comment'>-- | analogous to 'Data.Ord.Down'</span>
<a name="line-61"></a><a name="HEqByFn"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HDown</span> <span class='hs-varid'>a</span>
<a name="line-62"></a><a name="instance%20HEqByFn%20(HDown%20a)%20instance%20HEqBy%20f%20y%20x%20b%20=%3e%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-layout'>(</span><span class='hs-conid'>HDown</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-63"></a><a name="instance%20HEqBy%20(HDown%20f)%20x%20y%20b%20--%20%7c%20The%20HEqBy%20instances%20for%20@HNeq%20HLeFn@%20gives%20'%3c'%20data%20HNeq%20le%20instance%20HEqByFn%20a%20=%3e%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqBy</span> <span class='hs-varid'>f</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>HDown</span> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span>
<a name="line-64"></a>
<a name="line-65"></a><a name="HEqByFn"></a><span class='hs-comment'>-- | The HEqBy instances for @HNeq HLeFn@ gives '&lt;'</span>
<a name="line-66"></a><a name="HEqByFn"></a><span class='hs-keyword'>data</span> <span class='hs-conid'>HNeq</span> <span class='hs-varid'>le</span>
<a name="line-67"></a><a name="instance%20HEqByFn%20(HNeq%20a)%20instance%20(HEqBy%20le%20y%20x%20b1,%20HNot%20b1%20~%20b2)%20=%3e%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-layout'>(</span><span class='hs-conid'>HNeq</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<a name="line-68"></a><a name="instance%20HEqBy%20(HNeq%20le)%20x%20y%20b2%20%7b-%20%7c%20@HIsAscList%20le%20xs%20b@%20is%20analogous%20to%20%3e%20b%20=%20all%20(%5c(x,y)%20-%3e%20x%20%60le%60%20y)%20(xs%20%60zip%60%20tail%20xs)%20-%7d%20class%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20(xs%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20le%20xs%20-%3e%20b%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HEqBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span> <span class='hs-varid'>b1</span><span class='hs-layout'>,</span> <span class='hs-conid'>HNot</span> <span class='hs-varid'>b1</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>b2</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HEqBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>HNeq</span> <span class='hs-varid'>le</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b2</span>
<a name="line-69"></a>
<a name="line-70"></a><a name="HIsAscList"></a><span class='hs-comment'>{- | @HIsAscList le xs b@ is analogous to
<a name="line-71"></a>
<a name="line-72"></a>&gt; b = all (\(x,y) -&gt; x `le` y) (xs `zip` tail xs)
<a name="line-73"></a>
<a name="line-74"></a>-}</span>
<a name="line-75"></a><a name="HIsAscList"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>xs</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>le</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<a name="line-76"></a>
<a name="line-77"></a><a name="instance%20HIsAscList%20le%20'%5bx%5d%20True%20instance%20HEqByFn%20le%20=%3e%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-conid'>True</span>
<a name="line-78"></a><a name="instance%20HIsAscList%20le%20'%5b%5d%20True%20instance%20(HEqBy%20le%20x%20y%20b1,%20HIsAscList%20le%20(y%20':%20ys)%20b2,%20HAnd%20b1%20b2%20~%20b3)%20=%3e%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-conid'>True</span>
<a name="line-79"></a><a name="instance%20HIsAscList%20le%20(x%20':%20y%20':%20ys)%20b3%20--%20%7c%20quick%20sort%20with%20a%20special%20case%20for%20sorted%20lists%20class%20(SameLength%20a%20b,%20HEqByFn%20le)%20=%3e%20HSortBy%20le%20(a%20::%20%5b*%5d)%20(b%20::%20%5b*%5d)%20%7c%20le%20a%20-%3e%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HEqBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b1</span><span class='hs-layout'>,</span>
<a name="line-80"></a>         <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-varid'>b2</span><span class='hs-layout'>,</span>
<a name="line-81"></a>         <span class='hs-conid'>HAnd</span> <span class='hs-varid'>b1</span> <span class='hs-varid'>b2</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>b3</span><span class='hs-layout'>)</span>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-varid'>b3</span>
<a name="line-82"></a>
<a name="line-83"></a>
<a name="line-84"></a><a name="HSortBy"></a><span class='hs-comment'>-- | quick sort with a special case for sorted lists</span>
<a name="line-85"></a><a name="HSortBy"></a><span class='hs-keyword'>class</span> <span class='hs-layout'>(</span><span class='hs-conid'>SameLength</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSortBy</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>where</span>
<a name="line-86"></a>    <span class='hs-varid'>hSortBy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>b</span>
<a name="line-87"></a>
<a name="line-88"></a><a name="HSort"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>HSort</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HSortBy</span> <span class='hs-conid'>HLeFn</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span>
<a name="line-89"></a>
<a name="line-90"></a><a name="hSort"></a><span class='hs-definition'>hSort</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>HSort</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>y</span>
<a name="line-91"></a><span class='hs-definition'>hSort</span> <span class='hs-varid'>xs</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hSortBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-conid'>HLeFn</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span>
<a name="line-92"></a>
<a name="line-93"></a><a name="instance%20HSortBy%20le%20a%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>SameLength</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span>
<a name="line-94"></a>          <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-varid'>ok</span><span class='hs-layout'>,</span>
<a name="line-95"></a>          <span class='hs-conid'>HSortBy1</span> <span class='hs-varid'>ok</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>where</span>
<a name="line-96"></a>    <span class='hs-varid'>hSortBy</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hSortBy1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>ok</span><span class='hs-layout'>)</span>
<a name="line-97"></a>
<a name="line-98"></a><a name="instance%20HSortBy1%20True%20le%20a%20a"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HSortBy1</span> <span class='hs-conid'>True</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>where</span>
<a name="line-99"></a>    <span class='hs-varid'>hSortBy1</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>a</span> <span class='hs-comment'>-- already sorted</span>
<a name="line-100"></a>
<a name="line-101"></a><a name="instance%20HSortBy1%20False%20le%20a%20b"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSortBy1</span> <span class='hs-conid'>False</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>where</span>
<a name="line-102"></a>    <span class='hs-varid'>hSortBy1</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hQSortBy</span>
<a name="line-103"></a>
<a name="line-104"></a><a name="HMSortBy"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HSortBy1</span> <span class='hs-varid'>ok</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>ok</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>where</span>
<a name="line-105"></a>    <span class='hs-varid'>hSortBy1</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>ok</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>b</span>
<a name="line-106"></a>
<a name="line-107"></a><span class='hs-comment'>-- * Merge Sort</span>
<a name="line-108"></a>
<a name="line-109"></a><a name="HMSortBy"></a><span class='hs-comment'>{- | HMSortBy is roughly a transcription of this merge sort
<a name="line-110"></a>
<a name="line-111"></a>&gt; msort [] = []
<a name="line-112"></a>&gt; msort [x] = [x]
<a name="line-113"></a>&gt; msort [x,y] = hSort2 x y
<a name="line-114"></a>&gt; msort xs = case splitAt (length xs `div` 2) xs of
<a name="line-115"></a>&gt;              (a,b) -&gt; msort a `merge` msort b
<a name="line-116"></a>
<a name="line-117"></a>&gt; hSort2 x y
<a name="line-118"></a>&gt;     | x &lt;= y    = [x,y]
<a name="line-119"></a>&gt;     | otherwise = [y,x]
<a name="line-120"></a>
<a name="line-121"></a>&gt; merge (x : xs) (y : ys)
<a name="line-122"></a>&gt;   | x &gt; y     = y : merge (x : xs) ys
<a name="line-123"></a>&gt;   | otherwise = x : merge xs (y : ys)
<a name="line-124"></a>
<a name="line-125"></a>-}</span>
<a name="line-126"></a><a name="HMSortBy"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>where</span>
<a name="line-127"></a>    <span class='hs-varid'>hMSortBy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>b</span>
<a name="line-128"></a>
<a name="line-129"></a>
<a name="line-130"></a><a name="instance%20HMSortBy%20le%20'%5b%5d%20'%5b%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hMSortBy</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-131"></a><a name="instance%20HMSortBy%20le%20'%5bx%5d%20'%5bx%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hMSortBy</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-132"></a><a name="instance%20HMSortBy%20le%20'%5bx,y%5d%20ab"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HSort2</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>ab</span><span class='hs-layout'>,</span> <span class='hs-conid'>HEqBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<a name="line-133"></a>    <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-keyglyph'>]</span> <span class='hs-varid'>ab</span> <span class='hs-keyword'>where</span>
<a name="line-134"></a>      <span class='hs-varid'>hMSortBy</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`HCons`</span> <span class='hs-varid'>b</span> <span class='hs-varop'>`HCons`</span> <span class='hs-conid'>HNil</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>hSort2</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>a</span> <span class='hs-varid'>b</span>
<a name="line-135"></a>
<a name="line-136"></a><a name="HSort2"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HSort2</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>ab</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>ab</span> <span class='hs-keyword'>where</span>
<a name="line-137"></a>    <span class='hs-varid'>hSort2</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>ab</span>
<a name="line-138"></a>
<a name="line-139"></a><a name="instance%20HSort2%20True%20x%20y%20'%5bx,y%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HSort2</span> <span class='hs-conid'>True</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-layout'>,</span><span class='hs-varid'>y</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>where</span>
<a name="line-140"></a>    <span class='hs-varid'>hSort2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`HCons`</span> <span class='hs-varid'>y</span> <span class='hs-varop'>`HCons`</span> <span class='hs-conid'>HNil</span>
<a name="line-141"></a>
<a name="line-142"></a><a name="instance%20HSort2%20False%20x%20y%20'%5by,x%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HSort2</span> <span class='hs-conid'>False</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>y</span><span class='hs-layout'>,</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>where</span>
<a name="line-143"></a>    <span class='hs-varid'>hSort2</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>y</span> <span class='hs-varop'>`HCons`</span> <span class='hs-varid'>x</span> <span class='hs-varop'>`HCons`</span> <span class='hs-conid'>HNil</span>
<a name="line-144"></a>
<a name="line-145"></a><a name="instance%20HMSortBy%20le%20(a%20':%20b%20':%20c%20':%20cs)%20sorted"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-varid'>xs'</span> <span class='hs-varid'>ys'</span> <span class='hs-varid'>sorted</span><span class='hs-layout'>,</span>
<a name="line-146"></a>          <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ys</span> <span class='hs-varid'>ys'</span><span class='hs-layout'>,</span>
<a name="line-147"></a>          <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>xs'</span><span class='hs-layout'>,</span>
<a name="line-148"></a>          <span class='hs-conid'>HLengthEq</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>b</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>c</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-varid'>n2</span><span class='hs-layout'>,</span>
<a name="line-149"></a>          <span class='hs-conid'>HDiv2</span> <span class='hs-varid'>n2</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>n</span><span class='hs-layout'>,</span>
<a name="line-150"></a>          <span class='hs-conid'>HSplitAt</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>b</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>c</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span>
<a name="line-151"></a>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>b</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>c</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>cs</span><span class='hs-layout'>)</span> <span class='hs-varid'>sorted</span> <span class='hs-keyword'>where</span>
<a name="line-152"></a>  <span class='hs-varid'>hMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>abbs</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>hSplitAt</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>n</span><span class='hs-layout'>)</span> <span class='hs-varid'>abbs</span> <span class='hs-keyword'>of</span>
<a name="line-153"></a>      <span class='hs-layout'>(</span><span class='hs-varid'>xs</span><span class='hs-layout'>,</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>hMerge</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>hMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>hMSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span>
<a name="line-154"></a>
<a name="line-155"></a>
<a name="line-156"></a><a name="HMerge"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>xy</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>le</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xy</span> <span class='hs-keyword'>where</span>
<a name="line-157"></a>    <span class='hs-varid'>hMerge</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>xy</span>
<a name="line-158"></a>
<a name="line-159"></a><a name="instance%20HMerge%20le%20'%5b%5d%20'%5b%5d%20'%5b%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hMerge</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>HNil</span>
<a name="line-160"></a><a name="instance%20HMerge%20le%20(x%20':%20xs)%20'%5b%5d%20(x%20':%20xs)"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hMerge</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-161"></a><a name="instance%20HMerge%20le%20'%5b%5d%20(x%20':%20xs)%20(x%20':%20xs)"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hMerge</span> <span class='hs-keyword'>_</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-162"></a>
<a name="line-163"></a><a name="instance%20HMerge%20le%20(x%20':%20xs)%20(y%20':%20ys)%20(l%20':%20srt)"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HEqBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span><span class='hs-layout'>,</span>
<a name="line-164"></a>          <span class='hs-conid'>HMerge1</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ls</span><span class='hs-layout'>)</span> <span class='hs-varid'>hhs</span><span class='hs-layout'>,</span>
<a name="line-165"></a>          <span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ls</span> <span class='hs-varid'>hhs</span> <span class='hs-varid'>srt</span><span class='hs-layout'>)</span>
<a name="line-166"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HMerge</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>l</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>srt</span><span class='hs-layout'>)</span> <span class='hs-keyword'>where</span>
<a name="line-167"></a>  <span class='hs-varid'>hMerge</span> <span class='hs-varid'>le</span> <span class='hs-varid'>xxs</span> <span class='hs-varid'>yys</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>hMerge1</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-varid'>xxs</span> <span class='hs-varid'>yys</span> <span class='hs-keyword'>of</span>
<a name="line-168"></a>        <span class='hs-layout'>(</span><span class='hs-conid'>HCons</span> <span class='hs-varid'>l</span> <span class='hs-varid'>ls</span><span class='hs-layout'>,</span> <span class='hs-varid'>hhs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>l</span> <span class='hs-varop'>`HCons`</span> <span class='hs-varid'>hMerge</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ls</span> <span class='hs-varid'>hhs</span>
<a name="line-169"></a>
<a name="line-170"></a><a name="HMerge1"></a><span class='hs-keyword'>type</span> <span class='hs-conid'>HMerge1</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>min</span> <span class='hs-varid'>max</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-conid'>HCond</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>HList</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HList</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HList</span> <span class='hs-varid'>min</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span>
<a name="line-171"></a>                              <span class='hs-conid'>HCond</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-conid'>HList</span> <span class='hs-varid'>y</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HList</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-conid'>HList</span> <span class='hs-varid'>max</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span>
<a name="line-172"></a><a name="hMerge1"></a><span class='hs-definition'>hMerge1</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>hCond</span> <span class='hs-varid'>b</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span><span class='hs-layout'>,</span> <span class='hs-varid'>hCond</span> <span class='hs-varid'>b</span> <span class='hs-varid'>y</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<a name="line-173"></a>
<a name="line-174"></a><a name="HQSortBy"></a><span class='hs-comment'>-- * Quick sort</span>
<a name="line-175"></a><a name="HQSortBy"></a><span class='hs-comment'>{- | HQSortBy is this algorithm
<a name="line-176"></a>
<a name="line-177"></a>&gt; qsort (x : xs @ (_ : _)) = case partition (&lt;= x) xs of
<a name="line-178"></a>&gt;                  (le, gt) -&gt; qsort le ++ x : qsort gt
<a name="line-179"></a>&gt; qsort xs = xs
<a name="line-180"></a>
<a name="line-181"></a>on random inputs that are not pathological (ie. not already sorted or reverse
<a name="line-182"></a>sorted) this turns out to be faster than HMSortBy, so it is used by default.
<a name="line-183"></a>
<a name="line-184"></a>-}</span>
<a name="line-185"></a><a name="HQSortBy"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span> <span class='hs-keyword'>where</span>
<a name="line-186"></a>    <span class='hs-varid'>hQSortBy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>HList</span> <span class='hs-varid'>b</span>
<a name="line-187"></a>
<a name="line-188"></a><a name="instance%20HQSortBy%20le%20'%5b%5d%20'%5b%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hQSortBy</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-189"></a><a name="instance%20HQSortBy%20le%20'%5bx%5d%20'%5bx%5d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>where</span> <span class='hs-varid'>hQSortBy</span> <span class='hs-keyword'>_</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<a name="line-190"></a><a name="instance%20HQSortBy%20le%20(a%20':%20b%20':%20bs)%20sorted"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HPartitionEq</span> <span class='hs-varid'>le</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>bs</span><span class='hs-layout'>)</span> <span class='hs-varid'>bGeq</span> <span class='hs-varid'>bLt</span><span class='hs-layout'>,</span>
<a name="line-191"></a>        <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>bLt</span>  <span class='hs-varid'>sortedLt</span><span class='hs-layout'>,</span>
<a name="line-192"></a>        <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>bGeq</span> <span class='hs-varid'>sortedGeq</span><span class='hs-layout'>,</span>
<a name="line-193"></a>        <span class='hs-conid'>HAppendListR</span> <span class='hs-varid'>sortedLt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>sortedGeq</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>~</span> <span class='hs-varid'>sorted</span><span class='hs-layout'>,</span>
<a name="line-194"></a>        <span class='hs-conid'>HAppendList</span> <span class='hs-varid'>sortedLt</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>sortedGeq</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span>
<a name="line-195"></a>    <span class='hs-conid'>HQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>b</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>bs</span><span class='hs-layout'>)</span> <span class='hs-varid'>sorted</span> <span class='hs-keyword'>where</span>
<a name="line-196"></a>    <span class='hs-varid'>hQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`HCons`</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-keyword'>case</span> <span class='hs-varid'>hPartitionEq</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-conid'>Proxy</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Proxy</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span> <span class='hs-keyword'>of</span>
<a name="line-197"></a>                      <span class='hs-layout'>(</span><span class='hs-varid'>g</span><span class='hs-layout'>,</span><span class='hs-varid'>l</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>hQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>l</span> <span class='hs-varop'>`hAppendList`</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span> <span class='hs-varop'>`HCons`</span> <span class='hs-varid'>hQSortBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>g</span><span class='hs-layout'>)</span>
<a name="line-198"></a>
<a name="line-199"></a>
<a name="line-200"></a>
<a name="line-201"></a>
<a name="line-202"></a><a name="HSetBy"></a><span class='hs-comment'>-- * More efficient HRLabelSet / HLabelSet</span>
<a name="line-203"></a><a name="HSetBy"></a><span class='hs-comment'>{- | Provided the labels involved have an appropriate instance of HEqByFn,
<a name="line-204"></a>it would be possible to use the following definitions:
<a name="line-205"></a>
<a name="line-206"></a>&gt; type HRLabelSet = HSet
<a name="line-207"></a>&gt; type HLabelSet  = HSet
<a name="line-208"></a>
<a name="line-209"></a>-}</span>
<a name="line-210"></a><a name="HSetBy"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>lt</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSetBy</span> <span class='hs-varid'>lt</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-211"></a><a name="instance%20HSetBy%20lt%20ps%20class%20HSetBy%20(HNeq%20HLeFn)%20ps%20=%3e%20HSet%20(ps%20::%20%5b*%5d)%20instance%20HSetBy%20(HNeq%20HLeFn)%20ps%20=%3e%20HSet%20ps%20%7b-%20%7c%20%3e%3e%3e%20let%20xx%20=%20Proxy%20::%20HIsSet%20%5bLabel%20%22x%22,%20Label%20%22x%22%5d%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20xx%20xx%20::%20Proxy%20'False%20%3e%3e%3e%20let%20xy%20=%20Proxy%20::%20HIsSet%20%5bLabel%20%22x%22,%20Label%20%22y%22%5d%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20xy%20xy%20::%20Proxy%20'True%20-%7d%20class%20HIsSet%20(ps%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20ps%20-%3e%20b%20instance%20HIsSetBy%20(HNeq%20HLeFn)%20ps%20b%20=%3e%20HIsSet%20ps%20b%20class%20HEqByFn%20lt%20=%3e%20HIsSetBy%20lt%20(ps%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20lt%20ps%20-%3e%20b%20instance%20(HSortBy%20lt%20ps%20ps',%20HIsAscList%20lt%20ps'%20b)%20=%3e%20HIsSetBy%20lt%20ps%20b%20--%20%7c%20@HAscList%20le%20xs@%20confirms%20that%20xs%20is%20in%20ascending%20order,%20--%20and%20reports%20which%20element%20is%20duplicated%20otherwise.%20class%20HEqByFn%20le%20=%3e%20HAscList%20le%20(ps%20::%20%5b*%5d)%20instance%20HAscList0%20le%20ps%20ps%20=%3e%20HAscList%20le%20ps%20class%20HEqByFn%20le%20=%3e%20HAscList0%20le%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20class%20HEqByFn%20le%20=%3e%20HAscList1%20le%20(b%20::%20Bool)%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20instance%20(HAscList1%20le%20b%20(y%20':%20ys)%20ps0,%20HEqBy%20le%20x%20y%20b)%20=%3e%20HAscList0%20le%20(x%20':%20y%20':%20ys)%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HSortBy</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>ps'</span><span class='hs-layout'>,</span> <span class='hs-conid'>HAscList</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps'</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSetBy</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps</span>
<a name="line-212"></a>
<a name="line-213"></a><a name="HSet"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HSetBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>HNeq</span> <span class='hs-conid'>HLeFn</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSet</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-214"></a><a name="instance%20HSet%20ps%20%7b-%20%7c%20%3e%3e%3e%20let%20xx%20=%20Proxy%20::%20HIsSet%20%5bLabel%20%22x%22,%20Label%20%22x%22%5d%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20xx%20xx%20::%20Proxy%20'False%20%3e%3e%3e%20let%20xy%20=%20Proxy%20::%20HIsSet%20%5bLabel%20%22x%22,%20Label%20%22y%22%5d%20b%20=%3e%20Proxy%20b%20%3e%3e%3e%20:t%20xy%20xy%20::%20Proxy%20'True%20-%7d%20class%20HIsSet%20(ps%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20ps%20-%3e%20b%20instance%20HIsSetBy%20(HNeq%20HLeFn)%20ps%20b%20=%3e%20HIsSet%20ps%20b%20class%20HEqByFn%20lt%20=%3e%20HIsSetBy%20lt%20(ps%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20lt%20ps%20-%3e%20b%20instance%20(HSortBy%20lt%20ps%20ps',%20HIsAscList%20lt%20ps'%20b)%20=%3e%20HIsSetBy%20lt%20ps%20b%20--%20%7c%20@HAscList%20le%20xs@%20confirms%20that%20xs%20is%20in%20ascending%20order,%20--%20and%20reports%20which%20element%20is%20duplicated%20otherwise.%20class%20HEqByFn%20le%20=%3e%20HAscList%20le%20(ps%20::%20%5b*%5d)%20instance%20HAscList0%20le%20ps%20ps%20=%3e%20HAscList%20le%20ps%20class%20HEqByFn%20le%20=%3e%20HAscList0%20le%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20class%20HEqByFn%20le%20=%3e%20HAscList1%20le%20(b%20::%20Bool)%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20instance%20(HAscList1%20le%20b%20(y%20':%20ys)%20ps0,%20HEqBy%20le%20x%20y%20b)%20=%3e%20HAscList0%20le%20(x%20':%20y%20':%20ys)%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HSetBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>HNeq</span> <span class='hs-conid'>HLeFn</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HSet</span> <span class='hs-varid'>ps</span>
<a name="line-215"></a>
<a name="line-216"></a><a name="HIsSet"></a><span class='hs-comment'>{- |
<a name="line-217"></a>
<a name="line-218"></a>&gt;&gt;&gt; let xx = Proxy :: HIsSet [Label "x", Label "x"] b =&gt; Proxy b
<a name="line-219"></a>&gt;&gt;&gt; :t xx
<a name="line-220"></a>xx :: Proxy 'False
<a name="line-221"></a>
<a name="line-222"></a>&gt;&gt;&gt; let xy = Proxy :: HIsSet [Label "x", Label "y"] b =&gt; Proxy b
<a name="line-223"></a>&gt;&gt;&gt; :t xy
<a name="line-224"></a>xy :: Proxy 'True
<a name="line-225"></a>
<a name="line-226"></a>-}</span>
<a name="line-227"></a><a name="HIsSet"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HIsSet</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<a name="line-228"></a><a name="instance%20HIsSet%20ps%20b%20class%20HEqByFn%20lt%20=%3e%20HIsSetBy%20lt%20(ps%20::%20%5b*%5d)%20(b%20::%20Bool)%20%7c%20lt%20ps%20-%3e%20b%20instance%20(HSortBy%20lt%20ps%20ps',%20HIsAscList%20lt%20ps'%20b)%20=%3e%20HIsSetBy%20lt%20ps%20b%20--%20%7c%20@HAscList%20le%20xs@%20confirms%20that%20xs%20is%20in%20ascending%20order,%20--%20and%20reports%20which%20element%20is%20duplicated%20otherwise.%20class%20HEqByFn%20le%20=%3e%20HAscList%20le%20(ps%20::%20%5b*%5d)%20instance%20HAscList0%20le%20ps%20ps%20=%3e%20HAscList%20le%20ps%20class%20HEqByFn%20le%20=%3e%20HAscList0%20le%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20class%20HEqByFn%20le%20=%3e%20HAscList1%20le%20(b%20::%20Bool)%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20instance%20(HAscList1%20le%20b%20(y%20':%20ys)%20ps0,%20HEqBy%20le%20x%20y%20b)%20=%3e%20HAscList0%20le%20(x%20':%20y%20':%20ys)%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HIsSetBy</span> <span class='hs-layout'>(</span><span class='hs-conid'>HNeq</span> <span class='hs-conid'>HLeFn</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>b</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsSet</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>b</span>
<a name="line-229"></a>
<a name="line-230"></a><a name="HIsSetBy"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>lt</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsSetBy</span> <span class='hs-varid'>lt</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span>
<a name="line-231"></a><a name="instance%20HIsSetBy%20lt%20ps%20b%20--%20%7c%20@HAscList%20le%20xs@%20confirms%20that%20xs%20is%20in%20ascending%20order,%20--%20and%20reports%20which%20element%20is%20duplicated%20otherwise.%20class%20HEqByFn%20le%20=%3e%20HAscList%20le%20(ps%20::%20%5b*%5d)%20instance%20HAscList0%20le%20ps%20ps%20=%3e%20HAscList%20le%20ps%20class%20HEqByFn%20le%20=%3e%20HAscList0%20le%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20class%20HEqByFn%20le%20=%3e%20HAscList1%20le%20(b%20::%20Bool)%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20instance%20(HAscList1%20le%20b%20(y%20':%20ys)%20ps0,%20HEqBy%20le%20x%20y%20b)%20=%3e%20HAscList0%20le%20(x%20':%20y%20':%20ys)%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HSortBy</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>ps'</span><span class='hs-layout'>,</span> <span class='hs-conid'>HIsAscList</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps'</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HIsSetBy</span> <span class='hs-varid'>lt</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>b</span>
<a name="line-232"></a>
<a name="line-233"></a>
<a name="line-234"></a><a name="HAscList"></a><span class='hs-comment'>-- | @HAscList le xs@ confirms that xs is in ascending order,</span>
<a name="line-235"></a><a name="HAscList"></a><span class='hs-comment'>-- and reports which element is duplicated otherwise.</span>
<a name="line-236"></a><a name="HAscList"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-237"></a>
<a name="line-238"></a><a name="instance%20HAscList%20le%20ps%20class%20HEqByFn%20le%20=%3e%20HAscList0%20le%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20class%20HEqByFn%20le%20=%3e%20HAscList1%20le%20(b%20::%20Bool)%20(ps%20::%20%5b*%5d)%20(ps0%20::%20%5b*%5d)%20instance%20(HAscList1%20le%20b%20(y%20':%20ys)%20ps0,%20HEqBy%20le%20x%20y%20b)%20=%3e%20HAscList0%20le%20(x%20':%20y%20':%20ys)%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HAscList0</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ps</span> <span class='hs-varid'>ps</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ps</span>
<a name="line-239"></a>
<a name="line-240"></a><a name="HAscList0"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList0</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps0</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-241"></a>
<a name="line-242"></a><a name="HAscList1"></a><span class='hs-keyword'>class</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList1</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>b</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Bool</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>ps0</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varop'>*</span><span class='hs-keyglyph'>]</span><span class='hs-layout'>)</span>
<a name="line-243"></a><a name="instance%20HAscList0%20le%20(x%20':%20y%20':%20ys)%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span><span class='hs-conid'>HAscList1</span> <span class='hs-varid'>le</span> <span class='hs-varid'>b</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps0</span><span class='hs-layout'>,</span> <span class='hs-conid'>HEqBy</span> <span class='hs-varid'>le</span> <span class='hs-varid'>x</span> <span class='hs-varid'>y</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<a name="line-244"></a>  <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList0</span> <span class='hs-varid'>le</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-varid'>ps0</span>
<a name="line-245"></a><a name="instance%20HAscList0%20le%20'%5b%5d%20ps0%20instance%20HEqByFn%20le%20=%3e%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList0</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-conid'>[]</span> <span class='hs-varid'>ps0</span>
<a name="line-246"></a><a name="instance%20HAscList0%20le%20'%5bx%5d%20ps0%20instance%20(%20Fail%20'(%22Duplicated%20element%22,%20y,%20%22using%20le%22,%20le,%20%22in%22,%20ys0),%20HEqByFn%20le%20)%20=%3e%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList0</span> <span class='hs-varid'>le</span> <span class='hs-chr'>'</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>x</span><span class='hs-keyglyph'>]</span> <span class='hs-varid'>ps0</span>
<a name="line-247"></a>
<a name="line-248"></a><a name="instance%20HAscList1%20le%20False%20(y%20':%20ys)%20ys0%20instance%20HAscList0%20le%20ys%20ys0%20=%3e%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-layout'>(</span> <span class='hs-conid'>Fail</span> <span class='hs-chr'>'</span><span class='hs-layout'>(</span><span class='hs-str'>"Duplicated element"</span><span class='hs-layout'>,</span> <span class='hs-varid'>y</span><span class='hs-layout'>,</span> <span class='hs-str'>"using le"</span><span class='hs-layout'>,</span> <span class='hs-varid'>le</span><span class='hs-layout'>,</span> <span class='hs-str'>"in"</span><span class='hs-layout'>,</span> <span class='hs-varid'>ys0</span><span class='hs-layout'>)</span><span class='hs-layout'>,</span> <span class='hs-conid'>HEqByFn</span> <span class='hs-varid'>le</span> <span class='hs-layout'>)</span>
<a name="line-249"></a>    <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList1</span> <span class='hs-varid'>le</span> <span class='hs-conid'>False</span> <span class='hs-layout'>(</span><span class='hs-varid'>y</span> <span class='hs-chr'>'</span><span class='hs-conop'>:</span> <span class='hs-varid'>ys</span><span class='hs-layout'>)</span> <span class='hs-varid'>ys0</span>
<a name="line-250"></a><a name="instance%20HAscList1%20le%20True%20ys%20ys0%20%7b-%20$setup%20%3e%3e%3e%20import%20Data.HList.TypeEqO%20-%7d"></a><span class='hs-keyword'>instance</span> <span class='hs-conid'>HAscList0</span> <span class='hs-varid'>le</span> <span class='hs-varid'>ys</span> <span class='hs-varid'>ys0</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>HAscList1</span> <span class='hs-varid'>le</span> <span class='hs-conid'>True</span> <span class='hs-varid'>ys</span> <span class='hs-varid'>ys0</span>
<a name="line-251"></a>
<a name="line-252"></a><span class='hs-comment'>{- $setup
<a name="line-253"></a>
<a name="line-254"></a>&gt;&gt;&gt; import Data.HList.TypeEqO
<a name="line-255"></a>
<a name="line-256"></a>-}</span>
</pre></body>
</html>
